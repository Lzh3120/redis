# 缓存

## **缓存穿透**

> 问题来源

穿透是指查询了数据库中不存在的数据,导致每次都到数据库中查询.

>解决方案
1. 接口层做校验,如用户权限校验,id做基础校验,id<=0的直接拦截
2. 从缓存取不到数据,可以将null存入数据库,缓存有效期可以设置短一些,这样可以防止攻击用户反复攻击一个id的暴力方法
3. 布隆过滤器,类似于一个hashSet,用于快速判读某个元素是否存在于集合中.


## **缓存击穿**

> 问题来源

缓存中没有但数据库中有(一般是缓存到期),由于并发用户特别多,同时读缓存没有读到,同时到数据库中读取,引起数据库压力增大,造成过大压力

>解决方案

1. 设置热点数据永不过期
2. 接口限流与熔断,降级.重要的接口设置好限流策略,防止用户恶意刷接口.
3. 加互斥锁

## **缓存雪崩**

> 问题来源

是指缓存中数据大批量到期时间,而造成数据量巨大,引起数据库压力增大甚至宕机.缓存击穿是指并发查询同一条数据,雪崩是所有数据都过期.

>解决方案

1. 缓存数据的过期时间设置成随机,防止同一时间大量数据过期
2. 如果缓存数据是分布式部署,将热点数据均匀分不到不同的缓存数据库中
3. 设置热点数据永不过期
